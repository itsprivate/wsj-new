{"version":3,"file":"component---node-modules-gatsby-theme-buzzing-src-templates-detail-query-js-a838c82145b577c348c7.js","mappings":"oPAEA,ECOmB,SAAC,GAA+B,IAA7BA,EAA4B,EAA5BA,SAAUC,EAAkB,EAAlBA,YACtBC,EAAuBD,EAAvBC,SAAUC,EAAaF,EAAbE,SACVC,GAAWC,EAAAA,EAAAA,MAAXD,OAoCEE,GAlCGC,EAAAA,EAAAA,gBAAe,cAkC1BC,KAAQF,aAGV,GAAkCG,EAAAA,EAAAA,WAAS,GAAzBC,GAAlB,WACA,GAAwBD,EAAAA,EAAAA,UAAS,MAA1BE,EAAP,KAAaC,EAAb,KAuBA,IAtBAC,EAAAA,EAAAA,YAAU,WACR,IACIC,EADkBC,OAAOf,SACKgB,SAC9BF,EAAYG,WAAZ,IAA2Bb,KAC7BU,EAAcA,EAAYI,WAAU,IAAId,GAASe,SAEnD,IAAIC,GAAU,EAad,OAVAC,MAFS,kCAAqCP,EAArC,aAGNQ,MAAK,SAAAC,GAAI,OAAIA,EAAKC,UAClBF,MAAK,SAAAG,GACJ,GAAIL,EAAS,CACX,IAAIM,GAAQC,EAAAA,EAAAA,IAAWxB,EAAUsB,GACjCC,EAAME,WAAa,kBACnBhB,EAAQc,GACRhB,GAAa,OAGZ,kBAAOU,GAAU,KACvB,KAEEd,IAAiBJ,EACpB,OAAO,KAGT,IAAQ2B,EAAqBvB,EAArBuB,MAAOC,EAAcxB,EAAdwB,UAEf,OAAa,OAATnB,GAEA,QAAC,IAAD,CACET,SAAUA,EACV4B,UAAWA,EACX9B,SAAUA,EACV6B,MAAOA,EACP1B,SAAS,SACTF,YAAaA,EACbK,aAAcA,IAEd,QAACyB,EAAA,EAAD,CACEC,eAAgB,CACdC,KAAM7B,GAERyB,MAAO,uBAET,mCAMJ,QAAC,IAAD,CACE3B,SAAUA,EACV4B,UAAWA,EACX9B,SAAUA,EACV6B,MAAOA,EACP1B,SAAS,SACTF,YAAaA,EACbK,aAAcA,IAEd,QAAC,IAAD,CACEN,SAAUA,EACVC,YAAaA,EACbU,KAAMA,EACNL,aAAcA,KAGhB,qBACE,QAAC,IAAD,CACEK,KAAMA,EACNV,YAAaA,EACbD,SAAUA,KAEZ,QAAC,IAAD,CAEIE,SAAUA,EACVS,KAAAA,EACAV,YAAAA,EACAK,aAAAA","sources":["webpack://wsj/../../node_modules/gatsby-theme-buzzing/src/templates/detail-query.js","webpack://wsj/../../node_modules/gatsby-theme-buzzing/src/components/detail-page.js"],"sourcesContent":["import PostPage from \"../components/detail-page\"\n\nexport default PostPage\n","import React, { useState, useEffect } from \"react\"\nimport Layout from \"gatsby-theme-timeline/src/components/layout\"\nimport DetailFooter from \"gatsby-theme-timeline/src/components/detail-footer\"\nimport Detail from \"../gatsby-theme-timeline/components/detail\"\nimport DetailSEO from \"../gatsby-theme-timeline/components/detail-seo\"\nimport { useStaticQuery, graphql } from \"gatsby\"\nimport Helmet from \"react-helmet\"\nimport { useLocalization } from \"gatsby-theme-i18n\"\nimport { jsonToData } from \"../util\"\nconst DetailPage = ({ location, pageContext }) => {\n  const { basePath, pageType } = pageContext\n  const { locale } = useLocalization()\n\n  const data = useStaticQuery(graphql`\n    query DetailSiteQuery {\n      site {\n        siteMetadata {\n          title\n          author\n          description\n          keywords\n          siteUrl\n          telegram\n          iconUrl\n          defaultSocialImageUrl\n          social {\n            name\n            url\n            external\n          }\n          menuLinks {\n            name\n            url\n            external\n          }\n          disqus {\n            shortname\n          }\n          utterances {\n            repo\n            label\n          }\n        }\n      }\n    }\n  `)\n  const {\n    site: { siteMetadata },\n  } = data\n\n  const [isLoading, setIsLoading] = useState(true)\n  const [item, setItem] = useState(null)\n  useEffect(() => {\n    let currentLocation = window.location\n    let currentPath = currentLocation.pathname\n    if (currentPath.startsWith(`/${locale}`)) {\n      currentPath = currentPath.substring(`/${locale}`.length)\n    }\n    let mounted = true\n    const api = `https://json-api.buzzing.cc/ref${currentPath}data.json`\n\n    fetch(api)\n      .then(data => data.json())\n      .then(result => {\n        if (mounted) {\n          let _item = jsonToData(pageType, result)\n          _item.__typename = \"SocialMediaPost\"\n          setItem(_item)\n          setIsLoading(false)\n        }\n      })\n    return () => (mounted = false)\n  }, [])\n\n  if (!siteMetadata || !basePath) {\n    return null\n  }\n\n  const { title, menuLinks } = siteMetadata\n\n  if (item === null) {\n    return (\n      <Layout\n        basePath={basePath}\n        menuLinks={menuLinks}\n        location={location}\n        title={title}\n        pageType=\"detail\"\n        pageContext={pageContext}\n        siteMetadata={siteMetadata}\n      >\n        <Helmet\n          htmlAttributes={{\n            lang: locale,\n          }}\n          title={\"Loading Detail...\"}\n        ></Helmet>\n        <div>Loading...</div>\n      </Layout>\n    )\n  }\n\n  return (\n    <Layout\n      basePath={basePath}\n      menuLinks={menuLinks}\n      location={location}\n      title={title}\n      pageType=\"detail\"\n      pageContext={pageContext}\n      siteMetadata={siteMetadata}\n    >\n      <DetailSEO\n        location={location}\n        pageContext={pageContext}\n        item={item}\n        siteMetadata={siteMetadata}\n      ></DetailSEO>\n\n      <main>\n        <Detail\n          item={item}\n          pageContext={pageContext}\n          location={location}\n        ></Detail>\n        <DetailFooter\n          {...{\n            basePath: basePath,\n            item,\n            pageContext,\n            siteMetadata,\n          }}\n        />\n      </main>\n    </Layout>\n  )\n}\n\nexport default DetailPage\n"],"names":["location","pageContext","basePath","pageType","locale","useLocalization","siteMetadata","useStaticQuery","site","useState","setIsLoading","item","setItem","useEffect","currentPath","window","pathname","startsWith","substring","length","mounted","fetch","then","data","json","result","_item","jsonToData","__typename","title","menuLinks","Helmet","htmlAttributes","lang"],"sourceRoot":""}